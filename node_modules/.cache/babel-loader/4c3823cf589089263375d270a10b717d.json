{"remainingRequest":"/Users/nile/Blob/client/node_modules/babel-loader/lib/index.js!/Users/nile/Blob/client/node_modules/cache-loader/dist/cjs.js??ref--1-0!/Users/nile/Blob/client/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/nile/Blob/client/src/components/admin/AdminArticleManger.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/nile/Blob/client/src/components/admin/AdminArticleManger.vue","mtime":1694683583592},{"path":"/Users/nile/Blob/client/babel.config.js","mtime":1670838334534},{"path":"/Users/nile/Blob/client/node_modules/cache-loader/dist/cjs.js","mtime":1694758944082},{"path":"/Users/nile/Blob/client/node_modules/babel-loader/lib/index.js","mtime":1681398123605},{"path":"/Users/nile/Blob/client/node_modules/cache-loader/dist/cjs.js","mtime":1694758944082},{"path":"/Users/nile/Blob/client/node_modules/vue-loader/lib/index.js","mtime":1694570286908}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:ZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICJBZG1pbkFydGljbGVNYW5nZXIiLAogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICB0YWJsZURhdGE6IFtdLAogICAgICB0aXRlbElucHV0OiAnJywKICAgICAgZmxhZzogMCwKICAgICAgdGl0bGU6ICcnLAogICAgICBpbmRleDogMAogICAgfTsKICB9LAogIG1ldGhvZHM6IHsKICAgIHRhYmxlUm93Q2xhc3NOYW1lKHsKICAgICAgcm93LAogICAgICByb3dJbmRleAogICAgfSkgewogICAgICByZXR1cm4gKHJvd0luZGV4ICsgMSkgJSAyID09PSAwID8gJ3N1Y2Nlc3Mtcm93JyA6ICJ3cmFuaW5nLXJvdyI7CiAgICB9LAogICAgLy/or7fmsYLmlofnq6DmlbDmja4KICAgIGFzeW5jIGdldEFydGljbGUoKSB7CiAgICAgIGxldCByZXMgPSBhd2FpdCB0aGlzLiRheGlvcy5wb3N0KCcvYWRtaW4vZ2V0QXJ0aWNsZScpOwogICAgICB0aGlzLnRhYmxlRGF0YSA9IHJlcy5kYXRhLmRhdGEubWFwKGl0ZW0gPT4gewogICAgICAgIHJldHVybiB7CiAgICAgICAgICAuLi5pdGVtLAogICAgICAgICAgaXNFZGl0OiBmYWxzZQogICAgICAgIH07CiAgICAgIH0pOwogICAgICB0aGlzLmluZGV4Kys7CiAgICAgIGNvbnNvbGUubG9nKHRoaXMudGFibGVEYXRhKTsKICAgIH0sCiAgICAvL+ihqOagvOS6i+S7tuagvOW8j+WMlgogICAgZm10dGltZShyb3csIGNvbHVtbiwgY2VsbFZhbHVlLCBpbmRleCkgewogICAgICBsZXQgZGF0ZSA9IG5ldyBEYXRlKGNlbGxWYWx1ZSksCiAgICAgICAgWVkgPSBkYXRlLmdldEZ1bGxZZWFyKCksCiAgICAgICAgTU0gPSBkYXRlLmdldE1vbnRoKCkgKyAxLAogICAgICAgIEREID0gZGF0ZS5nZXREYXRlKCksCiAgICAgICAgaGggPSBkYXRlLmdldEhvdXJzKCksCiAgICAgICAgbW0gPSBkYXRlLmdldE1pbnV0ZXMoKSwKICAgICAgICBzcyA9IGRhdGUuZ2V0U2Vjb25kcygpOwogICAgICByZXR1cm4gYCR7WVl9LSR7TU19LSR7RER9ICR7aGh9OiR7bW19OiR7c3N9YDsKICAgIH0sCiAgICBhc3luYyBlZGl0QXJ0aWNsZShpLCByKSB7CiAgICAgIHRoaXMudGl0bGUgPSByLnRpdGxlOwogICAgICBjb25zb2xlLmxvZyhpLCByKTsKICAgICAgdGhpcy50YWJsZURhdGEuZm9yRWFjaChpdGVtID0+IHsKICAgICAgICBpZiAoaXRlbS5faWQgPT09IHIuX2lkKSB7CiAgICAgICAgICBpdGVtLmlzRWRpdCA9IHRydWU7CiAgICAgICAgICB0aGlzLmZsYWcrKzsKICAgICAgICB9CiAgICAgIH0pOwogICAgfSwKICAgIGFzeW5jIHRpdGxlSW5wdXRCbHVyKHIpIHsKICAgICAgbGV0IHsKICAgICAgICBkYXRhCiAgICAgIH0gPSBhd2FpdCB0aGlzLiRheGlvcyh7CiAgICAgICAgbWV0aG9kOiAicG9zdCIsCiAgICAgICAgdXJsOiAiL2FkbWluL2VkaXRBdGljbGVUaXRsZSIsCiAgICAgICAgZGF0YTogewogICAgICAgICAgbmV3TmFtZTogdGhpcy50aXRsZSwKICAgICAgICAgIGFydGljbGVJZDogci5faWQKICAgICAgICB9CiAgICAgIH0pOwogICAgICBpZiAoZGF0YS5jb2RlICE9PSAwKSByZXR1cm47CiAgICAgIHRoaXMuJG1lc3NhZ2Uuc3VjY2VzcyhkYXRhLm1zZyk7CiAgICAgIHRoaXMuZ2V0QXJ0aWNsZSgpOwogICAgICB0aGlzLnRhYmxlRGF0YS5mb3JFYWNoKGl0ZW0gPT4gewogICAgICAgIGlmIChpdGVtLl9pZCA9PT0gci5faWQpIHsKICAgICAgICAgIGl0ZW0uaXNFZGl0ID0gZmFsc2U7CiAgICAgICAgICB0aGlzLmZsYWcrKzsKICAgICAgICB9CiAgICAgIH0pOwogICAgfSwKICAgIC8v5Yig6Zmk5paH56ugCiAgICBhc3luYyBoYW5kbGVEZWxldGUoaW5kZXgsIHJvdykgewogICAgICBsZXQgewogICAgICAgIGRhdGEKICAgICAgfSA9IGF3YWl0IHRoaXMuJGF4aW9zKHsKICAgICAgICBtZXRob2Q6ICJkZWxldGUiLAogICAgICAgIHVybDogIi9hZG1pbi9hcnRpY2xlIiwKICAgICAgICBkYXRhOiB7CiAgICAgICAgICBfaWQ6IHJvdy5faWQKICAgICAgICB9CiAgICAgIH0pOwogICAgICBpZiAoZGF0YS5jb2RlICE9PSAwKSByZXR1cm47CgogICAgICAvL+WIoOmZpOaIkOWKn++8jOabtOaWsOaVsOaNrgogICAgICB0aGlzLiRtZXNzYWdlLnN1Y2Nlc3MoIuWIoOmZpOaIkOWKnyIpOwogICAgICB0aGlzLmdldEFydGljbGUoKTsKICAgICAgLy/kuovku7bovaborqlIb3RBcnRpY2xl5qih5Z2X5pu05paw5YaF5a65CiAgICAgIHRoaXMuJGJ1cy4kZW1pdCgiYXJ0aWNsZVVwZGF0ZSIpOwogICAgfQogIH0sCiAgYXN5bmMgY3JlYXRlZCgpIHsKICAgIHRoaXMuZ2V0QXJ0aWNsZSgpOwogIH0KfTs="},{"version":3,"names":["name","data","tableData","titelInput","flag","title","index","methods","tableRowClassName","row","rowIndex","getArticle","res","$axios","post","map","item","isEdit","console","log","fmttime","column","cellValue","date","Date","YY","getFullYear","MM","getMonth","DD","getDate","hh","getHours","mm","getMinutes","ss","getSeconds","editArticle","i","r","forEach","_id","titleInputBlur","method","url","newName","articleId","code","$message","success","msg","handleDelete","$bus","$emit","created"],"sources":["src/components/admin/AdminArticleManger.vue"],"sourcesContent":["<template>\r\n  <div id=\"AdminArticleManger\">\r\n    <el-table\r\n      :data=\"tableData\"\r\n      border\r\n      align=\"center\"\r\n      :row-class-name=\"tableRowClassName\"\r\n      style=\"width: 100%\"\r\n    >\r\n      <el-table-column\r\n        prop=\"_id\"\r\n        label=\"ID\"\r\n      >\r\n      </el-table-column>\r\n      <el-table-column\r\n        prop=\"title\"\r\n        label=\"标题\"\r\n        :key=\"flag\"\r\n      >\r\n        <template slot-scope=\"scope\">\r\n          <div v-if=\"scope.row.isEdit\">\r\n            <el-input\r\n              v-model=\"scope.row.title\"\r\n              placeholder=\"请输入内容\"\r\n              @blur=\"titleInputBlur(scope.row)\"\r\n            ></el-input>\r\n          </div>\r\n          <div v-else>{{ scope.row.title }}</div>\r\n        </template>\r\n\r\n      </el-table-column>\r\n      <el-table-column\r\n        prop=\"time\"\r\n        :formatter=\"fmttime\"\r\n        label=\"发表日期\"\r\n      >\r\n      </el-table-column>\r\n      <el-table-column\r\n        prop=\"pv\"\r\n        label=\"浏览量\"\r\n      >\r\n      </el-table-column>\r\n      <el-table-column\r\n        align=\"center\"\r\n        label=\"操作\"\r\n      >\r\n        <template slot-scope=\"scope\">\r\n          <el-button\r\n            :key=\"index\"\r\n            slot=\"reference\"\r\n            size=\"mini\"\r\n            type=\"primary\"\r\n            icon=\"el-icon-edit\"\r\n            :disabled=\"scope.row.isEdit\"\r\n            @click=\"editArticle(scope.$index, scope.row)\"\r\n          >编辑\r\n          </el-button>\r\n          <el-popconfirm\r\n            confirm-button-text='好的'\r\n            cancel-button-text='不用了'\r\n            icon=\"el-icon-info\"\r\n            icon-color=\"red\"\r\n            title=\"确定删除吗？\"\r\n            @confirm=\"handleDelete(scope.$index, scope.row)\"\r\n          >\r\n            <el-button\r\n              slot=\"reference\"\r\n              size=\"mini\"\r\n              icon=\"el-icon-delete\"\r\n              type=\"danger\"\r\n            >删除\r\n            </el-button>\r\n          </el-popconfirm>\r\n        </template>\r\n      </el-table-column>\r\n    </el-table>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  name: \"AdminArticleManger\",\r\n  data() {\r\n    return {\r\n      tableData: [],\r\n      titelInput: '',\r\n      flag: 0,\r\n      title: '',\r\n      index: 0\r\n    }\r\n  },\r\n  methods: {\r\n    tableRowClassName({ row, rowIndex }) {\r\n      return ((rowIndex + 1) % 2 === 0) ? 'success-row' : \"wraning-row\";\r\n    },\r\n    //请求文章数据\r\n    async getArticle() {\r\n      let res = await this.$axios.post('/admin/getArticle')\r\n\r\n      this.tableData = res.data.data.map(item => {\r\n        return {\r\n          ...item,\r\n          isEdit: false,\r\n        }\r\n      })\r\n      this.index++\r\n      console.log(this.tableData)\r\n    },\r\n\r\n    //表格事件格式化\r\n    fmttime(row, column, cellValue, index) {\r\n      let date = new Date(cellValue),\r\n        YY = date.getFullYear(),\r\n        MM = date.getMonth() + 1,\r\n        DD = date.getDate(),\r\n        hh = date.getHours(),\r\n        mm = date.getMinutes(),\r\n        ss = date.getSeconds()\r\n      return `${YY}-${MM}-${DD} ${hh}:${mm}:${ss}`\r\n    },\r\n\r\n    async editArticle(i, r) {\r\n      this.title = r.title\r\n      console.log(i, r)\r\n      this.tableData.forEach(item => {\r\n        if (item._id === r._id) {\r\n          item.isEdit = true\r\n          this.flag++\r\n        }\r\n      })\r\n    },\r\n    async titleInputBlur(r) {\r\n      let { data } = await this.$axios({\r\n        method: \"post\",\r\n        url: \"/admin/editAticleTitle\",\r\n        data: { newName: this.title, articleId: r._id }\r\n      })\r\n      if (data.code !== 0) return\r\n      this.$message.success(data.msg)\r\n      this.getArticle()\r\n      this.tableData.forEach(item => {\r\n        if (item._id === r._id) {\r\n          item.isEdit = false\r\n          this.flag++\r\n        }\r\n      })\r\n    },\r\n\r\n    //删除文章\r\n    async handleDelete(index, row) {\r\n      let { data } = await this.$axios({\r\n        method: \"delete\",\r\n        url: \"/admin/article\",\r\n        data: { _id: row._id }\r\n      })\r\n\r\n      if (data.code !== 0) return\r\n\r\n      //删除成功，更新数据\r\n      this.$message.success(\"删除成功\")\r\n      this.getArticle()\r\n      //事件车让HotArticle模块更新内容\r\n      this.$bus.$emit(\"articleUpdate\")\r\n\r\n    }\r\n  },\r\n  async created() {\r\n    this.getArticle()\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped lang=\"less\">\r\n/deep/.el-table .success-row {\r\n  background: #e4fcd7;\r\n}\r\n/deep/.el-table .wraning-row {\r\n  background: rgb(223, 185, 114) !important;\r\n}\r\n/deep/.el-table th,\r\n.el-table tr {\r\n  background: rgb(109, 171, 225) !important;\r\n  color: #fff;\r\n}\r\n/deep/.el-table--enable-row-hover .el-table__body tr:hover > td {\r\n  background-color: rgb(152, 228, 239);\r\n}\r\n.el-button {\r\n  margin: 0 2px;\r\n}\r\n</style>\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n"],"mappings":"AAgFA;EACAA,IAAA;EACAC,KAAA;IACA;MACAC,SAAA;MACAC,UAAA;MACAC,IAAA;MACAC,KAAA;MACAC,KAAA;IACA;EACA;EACAC,OAAA;IACAC,kBAAA;MAAAC,GAAA;MAAAC;IAAA;MACA,QAAAA,QAAA;IACA;IACA;IACA,MAAAC,WAAA;MACA,IAAAC,GAAA,cAAAC,MAAA,CAAAC,IAAA;MAEA,KAAAZ,SAAA,GAAAU,GAAA,CAAAX,IAAA,CAAAA,IAAA,CAAAc,GAAA,CAAAC,IAAA;QACA;UACA,GAAAA,IAAA;UACAC,MAAA;QACA;MACA;MACA,KAAAX,KAAA;MACAY,OAAA,CAAAC,GAAA,MAAAjB,SAAA;IACA;IAEA;IACAkB,QAAAX,GAAA,EAAAY,MAAA,EAAAC,SAAA,EAAAhB,KAAA;MACA,IAAAiB,IAAA,OAAAC,IAAA,CAAAF,SAAA;QACAG,EAAA,GAAAF,IAAA,CAAAG,WAAA;QACAC,EAAA,GAAAJ,IAAA,CAAAK,QAAA;QACAC,EAAA,GAAAN,IAAA,CAAAO,OAAA;QACAC,EAAA,GAAAR,IAAA,CAAAS,QAAA;QACAC,EAAA,GAAAV,IAAA,CAAAW,UAAA;QACAC,EAAA,GAAAZ,IAAA,CAAAa,UAAA;MACA,UAAAX,EAAA,IAAAE,EAAA,IAAAE,EAAA,IAAAE,EAAA,IAAAE,EAAA,IAAAE,EAAA;IACA;IAEA,MAAAE,YAAAC,CAAA,EAAAC,CAAA;MACA,KAAAlC,KAAA,GAAAkC,CAAA,CAAAlC,KAAA;MACAa,OAAA,CAAAC,GAAA,CAAAmB,CAAA,EAAAC,CAAA;MACA,KAAArC,SAAA,CAAAsC,OAAA,CAAAxB,IAAA;QACA,IAAAA,IAAA,CAAAyB,GAAA,KAAAF,CAAA,CAAAE,GAAA;UACAzB,IAAA,CAAAC,MAAA;UACA,KAAAb,IAAA;QACA;MACA;IACA;IACA,MAAAsC,eAAAH,CAAA;MACA;QAAAtC;MAAA,eAAAY,MAAA;QACA8B,MAAA;QACAC,GAAA;QACA3C,IAAA;UAAA4C,OAAA,OAAAxC,KAAA;UAAAyC,SAAA,EAAAP,CAAA,CAAAE;QAAA;MACA;MACA,IAAAxC,IAAA,CAAA8C,IAAA;MACA,KAAAC,QAAA,CAAAC,OAAA,CAAAhD,IAAA,CAAAiD,GAAA;MACA,KAAAvC,UAAA;MACA,KAAAT,SAAA,CAAAsC,OAAA,CAAAxB,IAAA;QACA,IAAAA,IAAA,CAAAyB,GAAA,KAAAF,CAAA,CAAAE,GAAA;UACAzB,IAAA,CAAAC,MAAA;UACA,KAAAb,IAAA;QACA;MACA;IACA;IAEA;IACA,MAAA+C,aAAA7C,KAAA,EAAAG,GAAA;MACA;QAAAR;MAAA,eAAAY,MAAA;QACA8B,MAAA;QACAC,GAAA;QACA3C,IAAA;UAAAwC,GAAA,EAAAhC,GAAA,CAAAgC;QAAA;MACA;MAEA,IAAAxC,IAAA,CAAA8C,IAAA;;MAEA;MACA,KAAAC,QAAA,CAAAC,OAAA;MACA,KAAAtC,UAAA;MACA;MACA,KAAAyC,IAAA,CAAAC,KAAA;IAEA;EACA;EACA,MAAAC,QAAA;IACA,KAAA3C,UAAA;EACA;AACA"}]}